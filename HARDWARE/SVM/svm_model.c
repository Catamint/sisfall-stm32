#include "svm_model.h"
#include "math.h"

#define MAX(x, y) ((x)>(y))?(x):(y)
#define MIN(x, y) ((x)<(y))?(x):(y)

#define KERNEL_UNKNOWN 0
#define KERNEL_LINEAR  1
#define KERNEL_POLYNOMIAL 2
#define KERNEL_RBF 3

typedef float (*KernelHandle)(const float *xi, const float *x, const Model *model);

static int32_t g_label[NR_CLASS] = {
1, -1
};

static float g_coefs[NR_CLASS-1][TOTAL_SV] = { 
{
18.836866f,117.943447f,0.785949f,128.000000f,128.000000f,81.999890f,128.000000f,10.435155f,18.181856f,3.779872f,
0.282369f,6.964337f,26.686260f,1.111288f,63.489990f,1.828812f,93.547016f,128.000000f,1.412733f,0.115139f,
1.693060f,14.685226f,2.472866f,15.582007f,1.336647f,13.301128f,0.368322f,96.188378f,1.901795f,18.503458f,
0.822392f,4.484385f,3.289176f,2.668898f,128.000000f,12.596512f,92.704596f,3.375773f,2.445217f,3.634424f,
6.917336f,14.685179f,6.358457f,5.782594f,83.291149f,1.478558f,2.885061f,9.209511f,1.216677f,128.000000f,
0.680143f,0.174158f,128.000000f,7.914459f,28.212103f,128.000000f,3.223352f,128.000000f,0.738902f,3.640078f,
2.246357f,8.549891f,20.721112f,1.715833f,128.000000f,0.664151f,0.241792f,13.622734f,1.444671f,0.263922f,
41.805472f,56.122787f,4.263288f,1.706150f,16.753631f,43.742286f,27.198447f,8.803099f,8.299315f,114.841849f,
22.656369f,3.577473f,36.370932f,0.402981f,6.658945f,2.312052f,128.000000f,52.207833f,25.604033f,20.460399f,
1.579764f,0.012519f,94.229649f,1.556765f,128.000000f,97.151085f,0.182654f,0.570032f,0.108093f,1.621552f,
23.591054f,1.097293f,128.000000f,16.880736f,124.419313f,3.127004f,6.168278f,23.392396f,53.940440f,0.226780f,
0.232263f,4.488877f,0.756386f,4.712482f,2.537054f,128.000000f,97.383424f,116.200836f,12.014664f,3.880302f,
1.358432f,4.013939f,0.115114f,85.581131f,0.379655f,0.630915f,128.000000f,3.864833f,3.073966f,0.193103f,
3.118815f,128.000000f,128.000000f,33.554013f,0.815671f,115.156918f,17.025442f,1.916691f,-5.806127f,-7.819842f,
-2.278402f,-0.067445f,-13.101751f,-78.779834f,-18.413288f,-77.636454f,-7.302797f,-0.719407f,-5.751980f,-5.264874f,
-1.633700f,-6.603808f,-10.476028f,-0.689764f,-7.007285f,-45.555175f,-67.207734f,-16.986609f,-14.555316f,-24.537535f,
-33.004374f,-70.749784f,-5.452534f,-7.097643f,-14.448164f,-128.000000f,-8.155460f,-24.043018f,-8.499900f,-31.243926f,
-2.562414f,-32.031736f,-0.789232f,-2.127691f,-1.918830f,-21.746780f,-9.973632f,-3.469456f,-128.000000f,-44.609607f,
-31.041144f,-6.351408f,-14.776098f,-128.000000f,-15.952815f,-26.903688f,-20.539084f,-11.323315f,-30.486069f,-15.268713f,
-2.122530f,-1.643118f,-27.101283f,-128.000000f,-0.630081f,-0.590866f,-7.513681f,-5.512040f,-4.584790f,-9.822488f,
-16.127373f,-6.200718f,-10.255623f,-4.406184f,-128.000000f,-57.117233f,-128.000000f,-37.202376f,-24.140849f,-13.604907f,
-0.900346f,-128.000000f,-33.714792f,-51.986124f,-10.592842f,-3.380319f,-74.900655f,-11.811718f,-39.546507f,-1.934659f,
-128.000000f,-27.246301f,-50.623358f,-49.975988f,-22.833653f,-1.449673f,-6.655903f,-28.881711f,-29.042163f,-35.823312f,
-128.000000f,-98.484607f,-19.773338f,-13.880898f,-83.241382f,-128.000000f,-77.596351f,-30.130919f,-0.767001f,-1.733415f,
-128.000000f,-44.358433f,-40.532666f,-7.525685f,-41.408709f,-19.501112f,-128.000000f,-10.040120f,-28.853220f,-13.736295f,
-61.946657f,-16.240898f,-40.549821f,-9.987910f,-39.093738f,-107.312071f,-20.429190f,-128.000000f,-59.979625f,-70.367079f,
-0.594281f,-7.903516f,-70.955335f,-69.422012f,-10.086186f,-101.924172f,-17.405906f,-8.434715f,-22.417103f,-2.655557f,
-42.073336f,
}, 

};

static float g_SVs[FEATURE_SIZE*TOTAL_SV] = {
0.21545652, 0.031691465, 0.052782422, 0.84855545, 0.29334862, 0.92498214, 0.068548387, 0.73069853, 0.049887586, 0.93584754, 0.0700842, 0.79897473, 0.19215855, 0.91641952,
0.21286501, 0.0019176325, 0.059469787, 0.87954334, 0.11215596, 0.69778519, 0.1733871, 0.87568934, 0.12137692, 0.97714356, 0.10054482, 0.89857195, 0.11495045, 0.94904287,
0.14765371, 0.039148929, 0.19918796, 0.91635601, 0.14220183, 0.97213622, 0.031754032, 0.78377757, 0.076927751, 0.94298246, 0.22919762, 0.65360674, 0.14011202, 0.8065067,
0.059861954, 0.0069471359, 0.048722235, 0.93010252, 0.040825688, 0.87306502, 0.048639113, 0.8839614, 0.028498511, 0.97210897, 0.052439326, 0.8854632, 0.054976303, 0.89673767,
0.21217638, 0.0024123696, 0.074755195, 0.86369991, 0.11834862, 0.69754704, 0.081149194, 0.83088235, 0.070122136, 0.86060662, 0.200842, 0.80512633, 0.17819905, 0.8408376,
0.13304706, 0.0099524607, 0.027943635, 0.91752097, 0.062614679, 0.82543463, 0.098538306, 0.80215993, 0.20808774, 0.9268594, 0.11428925, 0.92515562, 0.045842309, 0.89709715,
0.2231818, 0.0022876619, 0.068067829, 0.94291705, 0.10550459, 0.6377709, 0.053175403, 0.80284926, 0.073919912, 0.92485174, 0.12147103, 0.9171732, 0.072037915, 0.86564213,
0.33462078, 0.028637399, 0.05588727, 0.75652377, 0.24587156, 0.65825196, 0.11265121, 0.74241728, 0.11533086, 0.96673462, 0.09231055, 0.87989747, 0.20844464, 0.92459783,
0.26435577, 0.00035321657, 0.16694531, 0.83550792, 0.12798165, 0.70278638, 0.21622984, 0.87086397, 0.13565656, 0.97766864, 0.198737, 0.79597217, 0.11658768, 0.86591175,
0.20896628, 0.0011049955, 0.040363028, 0.91472507, 0.12866972, 0.74374851, 0.26789315, 0.91199449, 0.18484535, 0.96429454, 0.040799901, 0.87711461, 0.0316243, 0.89889458,
0.39022683, 0.051707905, 0.17506568, 0.83480895, 0.17775229, 0.62919743, 0.080645161, 0.50804228, 0.08200158, 0.86570299, 0.22913571, 0.64796778, 0.062817751, 0.59539858,
0.33556834, 0.042057814, 0.10652018, 0.79217148, 0.16926606, 0.64324839, 0.14818548, 0.68727022, 0.068511879, 0.82298616, 0.22795939, 0.66312706, 0.3712193, 0.81109014,
0.14590801, 0.036216134, 0.042990208, 0.8415657, 0.076834862, 0.85091688, 0.078881048, 0.78699449, 0.046667072, 0.86774154, 0.049839029, 0.71504943, 0.10245584, 0.91093736,
0.43936484, 0.001786141, 0.094339623, 0.88630009, 0.14059633, 0.30269112, 0.22429435, 0.83961397, 0.16211946, 0.97439461, 0.087171867, 0.83852069, 0.069021973, 0.9316078,
0.14646487, 0.0024399471, 0.040601863, 0.92311277, 0.12775229, 0.79518933, 0.14188508, 0.92991728, 0.1241417, 0.95509019, 0.055720654, 0.92640059, 0.039896596, 0.90087175,
0.30084257, 0.69644628, 0.48865536, 0.89701771, 0.11536697, 0.92688735, 0.16759073, 0.8917739, 0.044540317, 0.93294416, 0.20950966, 0.91856463, 0.21335631, 0.8197178,
0.21877911, 0.0026797858, 0.093861954, 0.89002796, 0.073623853, 0.63086449, 0.062752016, 0.82100184, 0.043719998, 0.90100692, 0.13434869, 0.82145734, 0.1971564, 0.80165364,
0.20058242, 0.0004770393, 0.082159064, 0.90377446, 0.11857798, 0.71564658, 0.15625, 0.88717831, 0.12657228, 0.93742278, 0.14995047, 0.85448554, 0.13657906, 0.81135976,
0.5183982, 0.00042157843, 0.1523764, 0.8499534, 0.23027523, 0.27292212, 0.15272177, 0.73644301, 0.03177979, 0.7246726, 0.12413323, 0.71988283, 0.11184834, 0.85162218,
0.29558348, 0.74413027, 0.4418438, 0.91006524, 0.26307339, 0.91831388, 0.13558468, 0.90119485, 0.086923498, 0.89306894, 0.26207281, 0.84804101, 0.29823352, 0.84326413,
0.12314373, 0.058201653, 0.11105804, 0.90657036, 0.1059633, 0.87973327, 0.076360887, 0.85340074, 0.044965668, 0.92676674, 0.21570084, 0.90655438, 0.057302887, 0.60124023,
0.098807598, 0.0036637191, 0.092906616, 0.90470643, 0.081651376, 0.8835437, 0.16456653, 0.96783088, 0.048398858, 0.90860514, 0.064759782, 0.7407543, 0.075657044, 0.73901321,
0.13737026, 0.070705273, 0.17482684, 0.93289842, 0.13188073, 0.92426768, 0.081149194, 0.83524816, 0.10694537, 0.89804176, 0.29414314, 0.8270963, 0.2612667, 0.82780624,
0.22131629, 0.0074442461, 0.055648436, 0.83038211, 0.10642202, 0.67516075, 0.11542339, 0.85500919, 0.1945069, 0.94684334, 0.054977712, 0.87184182, 0.12037915, 0.94383032,
0.16608104, 0.021365926, 0.14425603, 0.9361603, 0.10665138, 0.77113598, 0.095010081, 0.87408088, 0.08516133, 0.97856437, 0.19545567, 0.96484804, 0.018181818, 0.63997484,
0.27186178, 0.092795694, 0.16694531, 0.73438956, 0.1206422, 0.74660633, 0.10105847, 0.81020221, 0.080816674, 0.95549172, 0.061230807, 0.79084584, 0.24394657, 0.87337108,
0.37570936, 0.034724053, 0.084308574, 0.8082479, 0.16238532, 0.54322458, 0.15221774, 0.65923713, 0.058637662, 0.76581418, 0.4335686, 0.73335774, 0.36785868, 0.80704592,
0.16049114, 0.0088157897, 0.04681156, 0.9389562, 0.1043578, 0.75065492, 0.14012097, 0.90579044, 0.1384821, 0.97918211, 0.043833581, 0.94932259, 0.021370099, 0.94517839,
0.25938879, 0.012743561, 0.10365417, 0.74534017, 0.14977064, 0.78447249, 0.20110887, 0.83409926, 0.10244881, 0.96219422, 0.18647845, 0.56645917, 0.26359328, 0.81144963,
0.170466, 0.0025571397, 0.098638643, 0.91542404, 0.12431193, 0.87973327, 0.050655242, 0.70473346, 0.06589901, 0.82085495, 0.09131996, 0.7715855, 0.07022835, 0.79221713,
0.48669782, 0.031581068, 0.28636255, 0.60461323, 0.16582569, 0.4727316, 0.15826613, 0.81479779, 0.26310992, 0.96352236, 0.19477464, 0.66363969, 0.33261525, 0.87085468,
0.099347874, 0.3986196, 0.018151421, 0.82968313, 0.10527523, 0.92117171, 0.13860887, 0.93014706, 0.054657593, 0.96976155, 0.12314264, 0.80600513, 0.17483843, 0.86222702,
0.46055381, 0.00058135905, 0.042273704, 0.83527493, 0.21261468, 0.32031436, 0.20791331, 0.87178309, 0.17135565, 0.97312824, 0.065750371, 0.91468327, 0.11934511, 0.91767772,
0.39363464, 0.00096534776, 0.19871029, 0.84342964, 0.24518349, 0.60776375, 0.078881048, 0.61167279, 0.12936744, 0.81977391, 0.11577514, 0.78440132, 0.30038776, 0.84380336,
0.21645423, 0.00069131692, 0.04681156, 0.94268406, 0.11399083, 0.64777328, 0.13054435, 0.89935662, 0.16336513, 0.96741413, 0.049343735, 0.94683266, 0.01413184, 0.95039094,
0.095770131, 0.085291176, 0.03510867, 0.85135135, 0.079587156, 0.91474161, 0.083417339, 0.8683364, 0.067813089, 0.95107487, 0.049591382, 0.79004028, 0.16777251, 0.92226117,
0.27385013, 0.02099599, 0.11655123, 0.90726934, 0.16055046, 0.64396285, 0.045110887, 0.72311581, 0.19602601, 0.89702249, 0.12308073, 0.81266935, 0.10960793, 0.89925407,
0.14281459, 0.43111056, 0.12920946, 0.944315, 0.23990826, 0.93403191, 0.13709677, 0.94784007, 0.083763748, 0.93766988, 0.097139673, 0.79699744, 0.1424386, 0.88909859,
0.21393278, 0.00062866785, 0.057320277, 0.92567568, 0.26788991, 0.91331269, 0.074092742, 0.69623162, 0.075682081, 0.94579318, 0.044266964, 0.81288905, 0.026109436, 0.93331536,
0.29056882, 0.012607491, 0.25626941, 0.85950606, 0.1146789, 0.63062634, 0.066028226, 0.81410846, 0.047851978, 0.78338893, 0.28801387, 0.8041743, 0.23420939, 0.44126899,
0.086823488, 0.55226512, 0.02555529, 0.85135135, 0.079587156, 0.91474161, 0.083417339, 0.88511029, 0.067813089, 0.99098097, 0.034732541, 0.79004028, 0.16777251, 0.92226117,
0.16233368, 0.025170929, 0.040601863, 0.80964585, 0.10137615, 0.78232913, 0.087953629, 0.88648897, 0.068177675, 0.95129108, 0.088719663, 0.83310143, 0.2920293, 0.8874809,
0.26716323, 0.00020204317, 0.10198233, 0.91076421, 0.11697248, 0.57608955, 0.15725806, 0.89705882, 0.23846995, 0.91567828, 0.079309064, 0.95525449, 0.032313658, 0.94409994,
0.12504951, 0.0017556296, 0.060902794, 0.92357875, 0.076146789, 0.91450345, 0.26688508, 0.93910846, 0.079054506, 0.96599333, 0.055720654, 0.92251922, 0.040672124, 0.91623978,
0.21777037, 0.0025134243, 0.065201815, 0.93406337, 0.175, 0.71374137, 0.13331653, 0.89705882, 0.15993194, 0.94727576, 0.091505696, 0.87755401, 0.045152951, 0.90374764,
0.29407799, 0.024835454, 0.075471698, 0.8222274, 0.2059633, 0.8532984, 0.077116935, 0.54894301, 0.067478884, 0.89118483, 0.096520555, 0.76594654, 0.090736751, 0.90374764,
0.27695791, 0.00011800143, 0.12061142, 0.77609506, 0.16674312, 0.89521315, 0.45589718, 0.93956801, 0.053594215, 0.94712132, 0.077947003, 0.82738923, 0.03524343, 0.94122405,
0.33280663, 0.0028148861, 0.090757105, 0.80312209, 0.13302752, 0.59180757, 0.30922379, 0.84237132, 0.19113447, 0.90681369, 0.078689946, 0.82453314, 0.14140457, 0.85683473,
0.1538055, 0.26047993, 0.2139957, 0.93965517, 0.13761468, 0.91545606, 0.16355847, 0.90900735, 0.044358024, 0.96058809, 0.23972263, 0.87154888, 0.10271435, 0.81306731,
0.19236049, 0.0033193169, 0.029376642, 0.91425909, 0.10275229, 0.73827102, 0.25730847, 0.92210478, 0.10193231, 0.98220904, 0.042161961, 0.95137312, 0.023610513, 0.90976903,
0.53843777, 0.01621573, 0.34678768, 0.92614166, 0.18004587, 0.23839009, 0.071068548, 0.61213235, 0.024974175, 0.8322214, 0.14976474, 0.9110216, 0.047221025, 0.88047093,
0.41088503, 0.63430417, 0.5380941, 0.86509786, 0.3456422, 0.8404382, 0.096270161, 0.8203125, 0.048824209, 0.92655053, 0.27550768, 0.80754302, 0.29840586, 0.91390312,
0.051561642, 0.0023849076, 0.052304753, 0.93825722, 0.027522936, 0.87973327, 0.084173387, 0.91544118, 0.028133925, 0.98631702, 0.080113918, 0.92207982, 0.044205084, 0.93421407,
0.18971613, 0.074906182, 0.19823262, 0.9473439, 0.12637615, 0.75946654, 0.11542339, 0.90096507, 0.079206417, 0.93442674, 0.11441308, 0.95803735, 0.071090047, 0.72067943,
0.1287458, 0.031895147, 0.035825173, 0.78960857, 0.095183486, 0.91283639, 0.1499496, 0.91544118, 0.060369448, 0.97884235, 0.089462605, 0.85184914, 0.16906506, 0.86986609,
0.13429596, 0.024003822, 0.029376642, 0.87371855, 0.058027523, 0.81138366, 0.09702621, 0.82169118, 0.17305706, 0.86820484, 0.08927687, 0.93006225, 0.079362344, 0.94571762,
0.43171199, 0.002060262, 0.17984237, 0.81314073, 0.38073394, 0.65444153, 0.21270161, 0.75137868, 0.1260254, 0.85785767, 0.31271669, 0.72588795, 0.27781129, 0.68149546,
0.044282499, 0.0061766572, 0.040840697, 0.94035415, 0.021330275, 0.87973327, 0.078377016, 0.91544118, 0.028133925, 0.9842167, 0.04346211, 0.91094837, 0.043257217, 0.94913274,
0.36906182, 0.00105164, 0.10962503, 0.61742777, 0.17706422, 0.58966421, 0.17162298, 0.89545037, 0.15476697, 0.94007907, 0.099430411, 0.58154522, 0.54286945, 0.87813427,
0.30249703, 0.00024776383, 0.10054932, 0.92823858, 0.11399083, 0.74708264, 0.18245968, 0.60707721, 0.39785502, 0.91864344, 0.19595097, 0.92947638, 0.11512279, 0.83472634,
0.10230689, 0.14013314, 0.15357058, 0.93522833, 0.08853211, 0.93379376, 0.079889113, 0.87798713, 0.04842924, 0.95895107, 0.20721892, 0.9171732, 0.098664369, 0.81540397,
0.2722967, 0.016216668, 0.25889658, 0.86300093, 0.10573394, 0.66706359, 0.15751008, 0.89820772, 0.19049645, 0.9330677, 0.3070208, 0.87484438, 0.13623438, 0.92702436,
0.28473918, 0.00052882222, 0.074277526, 0.92334576, 0.17545872, 0.6015718, 0.18271169, 0.89568015, 0.26295801, 0.90826538, 0.078937593, 0.92771878, 0.034554072, 0.95794015,
0.095989624, 0.2982228, 0.12371626, 0.95456664, 0.073623853, 0.90545368, 0.12298387, 0.89039522, 0.10247919, 0.98316654, 0.26721149, 0.93474918, 0.10150797, 0.9303496,
0.14640873, 0.004642354, 0.058514449, 0.92054986, 0.058486239, 0.72850679, 0.096774194, 0.88855699, 0.13179802, 0.97003954, 0.057516097, 0.9140974, 0.085997415, 0.92262065,
0.2445125, 0.81863587, 0.44996417, 0.94315005, 0.091284404, 0.91474161, 0.1015625, 0.91222426, 0.062648113, 0.8962812, 0.17552006, 0.77956792, 0.085480396, 0.8159432,
0.39959058, 0.0016384652, 0.07236685, 0.71714818, 0.11995413, 0.8582996, 0.69732863, 0.89935662, 0.097466124, 0.96305906, 0.13583457, 0.82497254, 0.10409306, 0.87543812,
0.083344397, 0.22806451, 0.14186769, 0.95922647, 0.09587156, 0.91212193, 0.058215726, 0.91130515, 0.029865711, 0.93961576, 0.084819217, 0.92200659, 0.11581215, 0.72912735,
0.26059739, 0.0041558774, 0.047289229, 0.67870457, 0.18394495, 0.86925458, 0.040826613, 0.65211397, 0.047001276, 0.86212009, 0.16932888, 0.75957525, 0.12985782, 0.8767862,
0.3671761, 0.11661665, 0.092906616, 0.6055452, 0.12293578, 0.60895451, 0.3218246, 0.89108456, 0.15482773, 0.84998147, 0.44861317, 0.73020871, 0.55691512, 0.70036847,
0.19475178, 0.018122971, 0.10843086, 0.9361603, 0.066972477, 0.83686592, 0.33064516, 0.89476103, 0.071215896, 0.94007907, 0.10611689, 0.90472354, 0.051529513, 0.92855217,
0.11150982, 0.001631036, 0.064485312, 0.94315005, 0.097706422, 0.88259109, 0.040826613, 0.78676471, 0.031931701, 0.87592661, 0.13663943, 0.87660198, 0.070486859, 0.94041521,
0.16769579, 0.033866604, 0.2209219, 0.92101584, 0.091972477, 0.85472732, 0.11315524, 0.86259191, 0.096281218, 0.96824809, 0.3378529, 0.92801172, 0.050753985, 0.73460951,
0.25689821, 0.00070785499, 0.044423215, 0.91728798, 0.17454128, 0.76256251, 0.38986895, 0.92578125, 0.15689372, 0.82422165, 0.071879643, 0.89791285, 0.059284791, 0.92945089,
0.25689821, 7.5623335e-05, 0.044423215, 0.91728798, 0.17454128, 0.76256251, 0.38986895, 0.92578125, 0.15689372, 0.82422165, 0.071879643, 0.89791285, 0.050064627, 0.94634672,
0.2465999, 0.0010561211, 0.057559112, 0.90517241, 0.30986239, 0.82591093, 0.087701613, 0.79250919, 0.08227502, 0.89458241, 0.085624071, 0.89190773, 0.054717794, 0.91201582,
0.35195722, 0.0025819947, 0.06066396, 0.89352283, 0.12729358, 0.56013337, 0.30367944, 0.76240809, 0.13389439, 0.96809365, 0.090143635, 0.86590992, 0.035932788, 0.91821695,
0.10163908, 0.25997262, 0.17888703, 0.95922647, 0.1016055, 0.91450345, 0.07358871, 0.9129136, 0.033450811, 0.95320608, 0.13509163, 0.90992311, 0.064282637, 0.70809742,
0.35240558, 0.00010361376, 0.10054932, 0.84389562, 0.093348624, 0.45296499, 0.18321573, 0.78745404, 0.16780094, 0.93603286, 0.14023031, 0.88399854, 0.094442051, 0.82142536,
0.21948028, 0.0014661204, 0.084786243, 0.86136999, 0.081422018, 0.66801619, 0.14793347, 0.85409007, 0.18773166, 0.79571287, 0.11094601, 0.79282314, 0.18983197, 0.79050957,
0.1348324, 0.045482004, 0.045856222, 0.86206897, 0.11880734, 0.84496309, 0.13457661, 0.90877757, 0.065838245, 0.94520633, 0.065936107, 0.76572684, 0.27539854, 0.96036668,
0.14460857, 0.11212246, 0.069262001, 0.80125815, 0.13050459, 0.89973803, 0.089717742, 0.88419118, 0.038980373, 0.96219422, 0.22789747, 0.88582937, 0.36915123, 0.87076481,
0.15572072, 0.0017509314, 0.046095056, 0.93429637, 0.077981651, 0.82614908, 0.27746976, 0.92532169, 0.088229933, 0.93992464, 0.099863794, 0.95540095, 0.033175355, 0.94392019,
0.15112062, 0.67595093, 0.25531407, 0.94524697, 0.11192661, 0.94189093, 0.11945565, 0.89384191, 0.031688643, 0.93019521, 0.17279594, 0.83031856, 0.30805687, 0.86923699,
0.078713671, 0.75006675, 0.14186769, 0.96691519, 0.09587156, 0.91497976, 0.053931452, 0.91130515, 0.029865711, 0.93961576, 0.084819217, 0.92200659, 0.11581215, 0.72912735,
0.11187355, 0.5977997, 0.17649869, 0.9333644, 0.12912844, 0.96189569, 0.055695565, 0.87316176, 0.022513216, 0.92871263, 0.23124071, 0.92962285, 0.18130116, 0.95048081,
0.069859918, 0.00040897477, 0.042273704, 0.9333644, 0.043348624, 0.86234818, 0.044858871, 0.85960478, 0.040377955, 0.95861132, 0.084447746, 0.88143537, 0.087203791, 0.91129685,
0.19808471, 0.026275911, 0.09792214, 0.88024231, 0.12683486, 0.74303406, 0.14163306, 0.88074449, 0.15516194, 0.9074932, 0.12252353, 0.84071769, 0.10581646, 0.85647524,
0.30273973, 0.052472051, 0.23190829, 0.85228332, 0.1206422, 0.69302215, 0.14616935, 0.7265625, 0.17484961, 0.94786261, 0.10413571, 0.81977298, 0.064454976, 0.79653096,
0.28007451, 0.03346812, 0.068067829, 0.8362069, 0.15298165, 0.64848774, 0.1000504, 0.74310662, 0.010147658, 0.83883123, 0.11781823, 0.80695716, 0.11486428, 0.91803721,
0.26696198, 1.6585981e-05, 0.063768808, 0.89655172, 0.16238532, 0.75779948, 0.099798387, 0.63832721, 0.019353467, 0.87135532, 0.14369737, 0.92178689, 0.026195605, 0.9583895,
0.52495962, 0.076429485, 0.4265584, 0.81873253, 0.23692661, 0.37485116, 0.20967742, 0.89407169, 0.19162059, 0.85829009, 0.17694403, 0.62790187, 0.10547178, 0.4147569,
0.21206666, 0.0022034172, 0.078576546, 0.91169618, 0.080733945, 0.64110503, 0.1030746, 0.85454963, 0.20763201, 0.92210279, 0.078875681, 0.84328085, 0.041792331, 0.91084749,
0.13859945, 0.062728225, 0.13398615, 0.92451072, 0.094495413, 0.83234103, 0.082409274, 0.85340074, 0.068208057, 0.93556956, 0.27680783, 0.91878433, 0.094011202, 0.62038285,
0.17192789, 0.0031138058, 0.038930021, 0.91216216, 0.089908257, 0.71588473, 0.1391129, 0.90441176, 0.11803488, 0.96040277, 0.095468053, 0.89498352, 0.094528221, 0.94445942,
0.18754115, 0.0012446855, 0.037497015, 0.9277726, 0.11192661, 0.71016909, 0.1343246, 0.88625919, 0.18183752, 0.95922906, 0.054668153, 0.92976932, 0.042309349, 0.91857644,
0.35392408, 0.045663027, 0.23381896, 0.67730662, 0.14334862, 0.79233151, 0.18195565, 0.73598346, 0.35653521, 0.92068199, 0.16394255, 0.52193336, 0.42602327, 0.90248944,
0.46203085, 0.011573504, 0.11177454, 0.89328984, 0.19977064, 0.53084068, 0.13029234, 0.43382353, 0.037795467, 0.76294169, 0.12258544, 0.8268766, 0.10193882, 0.74683203,
0.13259632, 0.10357395, 0.14091235, 0.94944082, 0.11972477, 0.84663015, 0.070060484, 0.86374081, 0.047943125, 0.95749938, 0.12462853, 0.95049432, 0.091598449, 0.69686349,
0.38474745, 0.0083914986, 0.20157631, 0.59902144, 0.2412844, 0.81733746, 0.079385081, 0.66980699, 0.13210184, 0.8902891, 0.15973254, 0.80424753, 0.16475657, 0.77415296,
0.27351045, 0.00036969827, 0.093861954, 0.84249767, 0.1706422, 0.6744463, 0.079889113, 0.75045956, 0.027678192, 0.87388807, 0.23173601, 0.67125595, 0.048255062, 0.82537971,
0.12307242, 0.0093909019, 0.059230953, 0.86136999, 0.14495413, 0.91950464, 0.047631048, 0.82238051, 0.048611533, 0.87700766, 0.056215948, 0.84987184, 0.029814735, 0.76202031,
0.23744025, 0.0001847357, 0.085025078, 0.89538677, 0.094036697, 0.64324839, 0.14818548, 0.82628676, 0.068511879, 0.93047319, 0.1218425, 0.82160381, 0.16716932, 0.81109014,
0.22139972, 0.010891643, 0.18175305, 0.88466915, 0.07912844, 0.7973327, 0.29032258, 0.89315257, 0.077565777, 0.80633803, 0.06469787, 0.92713292, 0.12925463, 0.92289027,
0.11473529, 0.014456582, 0.035586339, 0.89841566, 0.068119266, 0.865206, 0.11844758, 0.84627757, 0.14711065, 0.93646528, 0.0596211, 0.90750641, 0.059887979, 0.94032533,
0.38196056, 0.0037254381, 0.23692381, 0.89701771, 0.13692661, 0.42224339, 0.18296371, 0.89981618, 0.26399101, 0.92330739, 0.27005944, 0.88927133, 0.24877208, 0.93187742,
0.15268429, 0.084118318, 0.035347504, 0.80871389, 0.17477064, 0.89116456, 0.053427419, 0.83180147, 0.016011424, 0.91719175, 0.076275384, 0.79743684, 0.053080569, 0.9278332,
0.26467179, 5.3330199e-05, 0.060186291, 0.91076421, 0.097247706, 0.54227197, 0.036542339, 0.81686581, 0.06535213, 0.90505313, 0.11020307, 0.92061516, 0.077552779, 0.84074773,
0.15711029, 0.01028433, 0.053976594, 0.91821994, 0.098623853, 0.83543701, 0.05015121, 0.72954963, 0.021237164, 0.90094514, 0.095715701, 0.93189308, 0.076863421, 0.87328121,
0.35876259, 0.024241673, 0.13995701, 0.78914259, 0.16743119, 0.66420576, 0.15171371, 0.62247243, 0.046727836, 0.77121942, 0.51523031, 0.61684365, 0.2521327, 0.82969354,
0.13643144, 0.51381997, 0.030809649, 0.80871389, 0.17477064, 0.91736128, 0.029485887, 0.83180147, 0.016011424, 0.91719175, 0.0397474, 0.79743684, 0.053080569, 0.9278332,
0.13827121, 0.064907199, 0.1378075, 0.91961789, 0.14633028, 0.87401762, 0.09375, 0.89682904, 0.04554293, 0.96648752, 0.13267707, 0.95598682, 0.084532529, 0.61813607,
0.35854503, 0.0095605468, 0.11464055, 0.71295433, 0.13004587, 0.67039771, 0.077368952, 0.55193015, 0.023060096, 0.82048431, 0.21631996, 0.82006591, 0.1535545, 0.92558641,
0.18240255, 0.056801326, 0.24050633, 0.92520969, 0.20091743, 0.94784472, 0.088709677, 0.82766544, 0.10378562, 0.84843711, 0.16115651, 0.94375687, 0.36691081, 0.94544801,
0.45110506, 0.00012991741, 0.044662049, 0.92124884, 0.15183486, 0.25434627, 0.13054435, 0.84237132, 0.27899982, 0.90418829, 0.10611689, 0.93863054, 0.048858251, 0.89898445,
0.066669747, 0.002477341, 0.052782422, 0.90703635, 0.039220183, 0.87306502, 0.045866935, 0.8839614, 0.028498511, 0.9655918, 0.10611689, 0.8854632, 0.071520896, 0.89673767,
0.20058242, 0.001868193, 0.082159064, 0.90377446, 0.11857798, 0.71564658, 0.15625, 0.88717831, 0.12657228, 0.93742278, 0.14995047, 0.85448554, 0.13657906, 0.81135976,
0.22060366, 0.0055730445, 0.051349415, 0.93266542, 0.052293578, 0.57751846, 0.12096774, 0.88993566, 0.16348666, 0.9423956, 0.056958891, 0.92889052, 0.026712624, 0.92414847,
0.27701887, 0.00029815167, 0.052304753, 0.92171482, 0.084862385, 0.61252679, 0.10332661, 0.6707261, 0.28127848, 0.9376081, 0.11144131, 0.86803369, 0.040241275, 0.93025973,
0.091070351, 0.70701104, 0.15524242, 0.97856477, 0.089678899, 0.90664444, 0.10131048, 0.90418199, 0.083429544, 0.9815913, 0.19607479, 0.93247895, 0.045239121, 0.79769929,
0.16704133, 0.57831569, 0.26582278, 0.94478099, 0.17775229, 0.94379614, 0.062752016, 0.85891544, 0.025369144, 0.94841858, 0.23817484, 0.87975101, 0.09461439, 0.87498877,
0.40210786, 0.002051342, 0.075949367, 0.81919851, 0.18440367, 0.41414623, 0.1890121, 0.86511949, 0.31913471, 0.79815295, 0.098315998, 0.76594654, 0.16992676, 0.76965939,
0.6359962, 9.6837044e-05, 0.048722235, 0.87581547, 0.29518349, 0.89997618, 0.85257056, 0.58547794, 0.030746795, 0.80087102, 0.12821942, 0.79428781, 0.13899181, 0.92307001,
0.074886927, 0.034850041, 0.099832816, 0.92730662, 0.11674312, 0.95451298, 0.021925403, 0.86741728, 0.031749408, 0.95885841, 0.13472016, 0.88934456, 0.10926325, 0.90815134,
0.53810512, 0.0016643729, 0.27179365, 0.79566636, 0.19931193, 0.41843296, 0.10584677, 0.43543199, 0.022087865, 0.84090067, 0.38657751, 0.79553277, 0.2213701, 0.7724454,
0.19268374, 0.014881652, 0.15452591, 0.88210624, 0.14885321, 0.81233627, 0.12978831, 0.87316176, 0.16430698, 0.97217074, 0.48408866, 0.88341267, 0.16251616, 0.88514424,
0.14844786, 0.001634504, 0.040601863, 0.92311277, 0.12775229, 0.79518933, 0.14188508, 0.9207261, 0.1241417, 0.95509019, 0.055720654, 0.92640059, 0.039896596, 0.90087175,
0.28735797, 0.00075000621, 0.137091, 0.75629077, 0.14311927, 0.81709931, 0.30216734, 0.83180147, 0.07416297, 0.8859958, 0.35004953, 0.89732699, 0.18879793, 0.84964501,
0.058767113, 0.016331009, 0.058514449, 0.94315005, 0.13233945, 0.95498928, 0.010332661, 0.87293199, 0.035273744, 0.94974673, 0.11992323, 0.94617356, 0.064282637, 0.96360205,
0.31517059, 0.56629916, 0.40219728, 0.8443616, 0.20045872, 0.86401524, 0.19178427, 0.89016544, 0.067235827, 0.85912404, 0.39004458, 0.91087514, 0.52391211, 0.89287319,
0.095225224, 0.76667328, 0.15357058, 0.95503262, 0.096100917, 0.93593713, 0.079889113, 0.87798713, 0.04842924, 0.95895107, 0.20721892, 0.9171732, 0.050409306, 0.81540397,
0.11716003, 0.0058399886, 0.052543587, 0.94874185, 0.065137615, 0.79614194, 0.11391129, 0.89085478, 0.10679346, 0.99372992, 0.046929173, 0.94990846, 0.051529513, 0.95785027,
0.069284338, 0.0013999737, 0.042273704, 0.92707363, 0.037155963, 0.86234818, 0.046875, 0.85960478, 0.040377955, 0.97121324, 0.082714215, 0.88143537, 0.065661353, 0.91129685,
0.22531368, 0.0039868766, 0.095056126, 0.87884436, 0.17018349, 0.84424863, 0.086441532, 0.68152574, 0.047396245, 0.83978873, 0.19805597, 0.80790919, 0.19241706, 0.85611575,
0.16318819, 0.073742864, 0.059708622, 0.79426841, 0.11743119, 0.8280543, 0.073336694, 0.8683364, 0.024700735, 0.9462256, 0.066617137, 0.84474551, 0.35252047, 0.93385459,
0.1862824, 0.0062529936, 0.062096967, 0.93872321, 0.10252294, 0.75827578, 0.14238911, 0.8125, 0.26070973, 0.91716086, 0.059992571, 0.884145, 0.058767773, 0.94239238,
0.12829098, 0.0024359634, 0.077860043, 0.87162162, 0.15137615, 0.93093594, 0.14415323, 0.89682904, 0.03743088, 0.91187917, 0.039933135, 0.68246064, 0.16165446, 0.865732,
0.42814284, 0.025023321, 0.31215668, 0.75046598, 0.22293578, 0.58251965, 0.10131048, 0.73690257, 0.069939843, 0.7626637, 0.2792843, 0.55034786, 0.10366221, 0.814685,
0.28295095, 0.00061747619, 0.097683305, 0.86416589, 0.11651376, 0.70183377, 0.31930444, 0.82950368, 0.085404387, 0.90045095, 0.17589153, 0.76323691, 0.20112021, 0.82052665,
0.24874838, 0.00026346344, 0.04681156, 0.94012116, 0.15711009, 0.64658252, 0.10685484, 0.83088235, 0.18524032, 0.93899802, 0.04346211, 0.92178689, 0.096854804, 0.90347803,
0.36367838, 0.0014518905, 0.096966802, 0.92101584, 0.12545872, 0.48654442, 0.091229839, 0.6261489, 0.302941, 0.72952187, 0.10834572, 0.88333944, 0.091426109, 0.88523412,
0.31298245, 0.014253277, 0.14759971, 0.87325256, 0.14082569, 0.54917838, 0.10559476, 0.8113511, 0.26396062, 0.63516185, 0.17812036, 0.73379714, 0.31607066, 0.47092657,
0.24927526, 0.00033430545, 0.14210652, 0.89981361, 0.091284404, 0.6313408, 0.083921371, 0.7734375, 0.090417452, 0.91858167, 0.15546062, 0.87154888, 0.18302456, 0.75752674,
0.25320921, 9.7272478e-05, 0.083353236, 0.86020503, 0.12545872, 0.62348178, 0.12726815, 0.87132353, 0.20301392, 0.91623425, 0.097511144, 0.86349323, 0.050667816, 0.89808574,
0.25578412, 0.0001634628, 0.037497015, 0.93383038, 0.056422018, 0.59537985, 0.19279234, 0.79365809, 0.23509753, 0.93726835, 0.052934621, 0.95715855, 0.019646704, 0.94697582,
0.099697109, 0.019912221, 0.032242656, 0.85391426, 0.10986239, 0.89521315, 0.10861895, 0.92715993, 0.037916996, 0.97220163, 0.072870233, 0.83376053, 0.19190004, 0.93457356,
0.20958937, 0.00051936384, 0.030809649, 0.94058714, 0.17270642, 0.8285306, 0.058971774, 0.67417279, 0.083064957, 0.94925253, 0.059992571, 0.94177957, 0.014993537, 0.96018693,
0.47922263, 0.0035089749, 0.14879389, 0.87022367, 0.20802752, 0.29888069, 0.1000504, 0.75712316, 0.10445403, 0.91570917, 0.39673105, 0.71021604, 0.39965532, 0.57113328,
0.37379619, 0.00086613203, 0.18032004, 0.72017707, 0.20688073, 0.64658252, 0.20665323, 0.79159007, 0.10943671, 0.85841364, 0.24393264, 0.68846576, 0.15872469, 0.77208592,
0.21653591, 6.6885045e-05, 0.090757105, 0.84366263, 0.12591743, 0.70207192, 0.082157258, 0.86006434, 0.072583095, 0.89686805, 0.147474, 0.75884291, 0.18578199, 0.8452413,
0.53526033, 0.0059612269, 0.17482684, 0.73625349, 0.25045872, 0.29626101, 0.13482863, 0.75229779, 0.17330012, 0.8752471, 0.22734027, 0.56484804, 0.25557949, 0.72795902,
0.23971634, 0.69405461, 0.3455935, 0.85764212, 0.088990826, 0.89211717, 0.079385081, 0.87982537, 0.087439995, 0.93631085, 0.15403665, 0.89315269, 0.2615252, 0.92351937,
0.067895901, 0.0088126867, 0.064962981, 0.93219944, 0.12247706, 0.98094784, 0.13104839, 0.92693015, 0.10955824, 0.96305906, 0.047672115, 0.76404248, 0.17078845, 0.93277613,
0.45901347, 3.5571785e-05, 0.15333174, 0.84319664, 0.096100917, 0.73446059, 0.69783266, 0.79434743, 0.12064775, 0.83234495, 0.078875681, 0.75269132, 0.15536407, 0.76130134,
0.23971634, 0.14389078, 0.3455935, 0.85764212, 0.088990826, 0.89211717, 0.079385081, 0.87982537, 0.087439995, 0.93631085, 0.15403665, 0.89315269, 0.2615252, 0.92351937,
0.28647934, 0.0026604744, 0.10556484, 0.84109972, 0.15, 0.62514884, 0.080897177, 0.75988051, 0.071489336, 0.89408821, 0.22529718, 0.75173929, 0.13373546, 0.87247236,
0.2593067, 0.0014988583, 0.05111058, 0.9000466, 0.099082569, 0.55870445, 0.091733871, 0.85386029, 0.167011, 0.95681987, 0.063026251, 0.92647382, 0.022748815, 0.94661634,
0.19815238, 5.7850829e-05, 0.044423215, 0.93662628, 0.13486239, 0.73827102, 0.14818548, 0.84926471, 0.12657228, 0.95295898, 0.055720654, 0.95056756, 0.038173201, 0.90132111,
0.29472581, 0.063167827, 0.1308813, 0.91332712, 0.15527523, 0.56751608, 0.099798387, 0.84627757, 0.142766, 0.89594144, 0.10624071, 0.89066276, 0.12442913, 0.87552799,
0.22276527, 3.6896409e-05, 0.068545498, 0.87651445, 0.1043578, 0.72469636, 0.16204637, 0.79273897, 0.17901197, 0.94801705, 0.10976969, 0.90032955, 0.050150797, 0.90743237,
0.20523963, 0.00026335071, 0.074994029, 0.87558248, 0.096559633, 0.72064777, 0.12575605, 0.81158088, 0.054718357, 0.94390907, 0.22554482, 0.85624313, 0.11796639, 0.83050238,
0.15067974, 0.015912211, 0.051827084, 0.83434296, 0.077293578, 0.83138843, 0.056451613, 0.78193934, 0.12426323, 0.85251421, 0.076337296, 0.84350055, 0.059370961, 0.94661634,
0.32009958, 8.5071848e-05, 0.14688321, 0.66845294, 0.082110092, 0.66563467, 0.10735887, 0.74034926, 0.095308987, 0.91536941, 0.1218425, 0.72976932, 0.372081, 0.83122135,
0.045019884, 0.83227987, 0.094100788, 0.96784716, 0.076834862, 0.93522267, 0.077620968, 0.94025735, 0.026098317, 0.9854213, 0.062097573, 0.91812523, 0.042912538, 0.80866361,
0.025468495, 7.049535e-05, 0.040840697, 0.93988816, 0.01766055, 0.90402477, 0.026461694, 0.89682904, 0.012487088, 0.98770694, 0.043833581, 0.84467228, 0.022662645, 0.93861778,
0.19528118, 0.0018924125, 0.045139718, 0.93476235, 0.12408257, 0.73779471, 0.23639113, 0.92348346, 0.11381175, 0.94363108, 0.044081228, 0.92347126, 0.019302025, 0.92064348,
0.25920415, 0.0037157486, 0.078576546, 0.84739049, 0.12133028, 0.64515361, 0.13533266, 0.80399816, 0.14355593, 0.86795775, 0.14920753, 0.75554742, 0.20534252, 0.75914442,
0.20117794, 0.0066564712, 0.046095056, 0.9277726, 0.077752294, 0.63443677, 0.089969758, 0.88534007, 0.081910433, 0.97071905, 0.090453195, 0.88868546, 0.055234813, 0.95623259,
0.1959973, 0.0074364787, 0.12204442, 0.8415657, 0.093119266, 0.74493927, 0.060735887, 0.82490809, 0.13750987, 0.89106128, 0.18257801, 0.76704504, 0.091856958, 0.74269794,
0.22110539, 0.0031865135, 0.09792214, 0.85344828, 0.10573394, 0.70897833, 0.19657258, 0.88488051, 0.084948654, 0.91379417, 0.1066741, 0.88487733, 0.1749246, 0.78340972,
0.3558231, 0.012498913, 0.066157153, 0.91332712, 0.13646789, 0.44677304, 0.1078629, 0.75804228, 0.10238804, 0.96145293, 0.090143635, 0.92859758, 0.15751831, 0.94104431,
0.12487289, 0.00033042035, 0.074994029, 0.90377446, 0.07293578, 0.84305787, 0.12096774, 0.86259191, 0.070243665, 0.96321349, 0.11596087, 0.88736726, 0.11434726, 0.843354,
0.35029243, 0.0034605091, 0.11798424, 0.7749301, 0.089908257, 0.57561324, 0.20690524, 0.69990809, 0.21322234, 0.68711391, 0.13868252, 0.72757232, 0.36329168, 0.80309158,
0.16835217, 0.00055583327, 0.035825173, 0.94338304, 0.097477064, 0.77613718, 0.064516129, 0.75942096, 0.32931275, 0.58944897, 0.06265478, 0.93518858, 0.073933649, 0.95488452,
0.58651609, 0.010573856, 0.12419393, 0.74207829, 0.083715596, 0.27673256, 0.43926411, 0.57720588, 0.15759251, 0.89161725, 0.35939822, 0.81581838, 0.28978888, 0.2637728,
0.031787334, 0.021526538, 0.048722235, 0.944315, 0.015825688, 0.88211479, 0.035534274, 0.91314338, 0.028741569, 0.97402397, 0.038447251, 0.82358111, 0.046359328, 0.92576615,
0.35420431, 0.0029593406, 0.10699785, 0.86160298, 0.13830275, 0.69468921, 0.46900202, 0.82421875, 0.1178222, 0.89646652, 0.12617632, 0.87030392, 0.23800086, 0.83796171,
0.23226145, 0.00010471292, 0.090279436, 0.85018639, 0.12522936, 0.66992141, 0.084425403, 0.84512868, 0.061736647, 0.95033358, 0.14821694, 0.81450018, 0.3470056, 0.79275636,
0.19273215, 0.00020323533, 0.057559112, 0.93196645, 0.11100917, 0.68992617, 0.087449597, 0.87224265, 0.14704989, 0.94282802, 0.092620109, 0.92713292, 0.037828522, 0.90096162,
0.084153914, 0.1307165, 0.11129687, 0.94897484, 0.10114679, 0.90402477, 0.084173387, 0.91796875, 0.042261652, 0.96753768, 0.098439822, 0.89190773, 0.034640241, 0.792307,
0.045611204, 0.027172339, 0.056126105, 0.93406337, 0.029357798, 0.89283163, 0.047379032, 0.89636949, 0.021510603, 0.9897146, 0.063893016, 0.93533504, 0.089616545, 0.910488,
0.30526225, 0.022680297, 0.098638643, 0.90796831, 0.17155963, 0.56132412, 0.058467742, 0.79273897, 0.13243605, 0.92312207, 0.081599802, 0.83449286, 0.15364067, 0.90302867,
0.22292393, 2.7439441e-05, 0.043467877, 0.94268406, 0.15619266, 0.78947368, 0.14516129, 0.74080882, 0.1895546, 0.8778725, 0.093301139, 0.90062248, 0.050409306, 0.85917138,
0.052082816, 5.5982264e-05, 0.054931932, 0.92590867, 0.022018349, 0.88759228, 0.060987903, 0.89430147, 0.013520083, 0.99039412, 0.057516097, 0.91548883, 0.060749677, 0.92648513,
0.050948667, 0.0016089965, 0.037735849, 0.93709226, 0.043807339, 0.89997618, 0.10030242, 0.92118566, 0.06687124, 0.98792315, 0.0350421, 0.95481509, 0.01740629, 0.95596297,
0.19273215, 0.00016477333, 0.057559112, 0.93196645, 0.11100917, 0.68992617, 0.087449597, 0.87224265, 0.14704989, 0.94282802, 0.092620109, 0.92713292, 0.037828522, 0.90096162,
0.26757531, 0.0022622925, 0.10890853, 0.81244175, 0.13830275, 0.64515361, 0.11315524, 0.84673713, 0.055964027, 0.93504448, 0.1129891, 0.69476382, 0.24222318, 0.78781343,
0.22080004, 0.0012910699, 0.076188202, 0.87558248, 0.082110092, 0.75803763, 0.094758065, 0.68910846, 0.080968585, 0.76368298, 0.16400446, 0.77341633, 0.16949591, 0.87489889,
0.066622138, 0.08192015, 0.024122283, 0.88699907, 0.077522936, 0.90997857, 0.089969758, 0.91842831, 0.051072492, 0.98721275, 0.064140664, 0.91065544, 0.13856097, 0.96423115,
0.17988276, 0.0091901538, 0.039885359, 0.93569432, 0.076605505, 0.67087402, 0.096522177, 0.8972886, 0.093394908, 0.95583148, 0.066555225, 0.92720615, 0.1068505, 0.94338097,
0.34128658, 0.00075467621, 0.10890853, 0.86369991, 0.25344037, 0.58752084, 0.10861895, 0.84581801, 0.12891171, 0.88055967, 0.29909609, 0.84716221, 0.23601896, 0.6441988,
0.063094232, 0.61681383, 0.021972773, 0.88164026, 0.076376147, 0.91116933, 0.072832661, 0.91727941, 0.016801361, 0.97652582, 0.046991085, 0.89234713, 0.1424386, 0.95236811,
0.16043263, 0.0050581477, 0.040363028, 0.90237651, 0.15986239, 0.91855204, 0.071068548, 0.72817096, 0.050859816, 0.84831357, 0.085500248, 0.83529843, 0.18466178, 0.92927114,
0.2424275, 2.9695528e-05, 0.063768808, 0.92148183, 0.14770642, 0.65182186, 0.14868952, 0.87522978, 0.21613903, 0.88398814, 0.12332838, 0.85558404, 0.10728134, 0.9079716,
0.55284766, 0.010273455, 0.20038214, 0.84739049, 0.1456422, 0.48059062, 0.47328629, 0.56456801, 0.12748375, 0.72664937, 0.28962358, 0.72552179, 0.25351142, 0.68904467,
0.54359182, 0.014066906, 0.20444232, 0.84739049, 0.1456422, 0.45558466, 0.47328629, 0.60638787, 0.10870754, 0.75466395, 0.28962358, 0.65865983, 0.27281344, 0.73272221,
0.28797002, 2.7360527e-05, 0.11225221, 0.86416589, 0.11651376, 0.70635866, 0.31930444, 0.81962316, 0.085404387, 0.90045095, 0.17589153, 0.84642988, 0.20585954, 0.82052665,
0.060938926, 0.46253542, 0.0016718414, 0.87651445, 0.083944954, 0.92212432, 0.081149194, 0.91153493, 0.058424986, 0.98322832, 0.040366518, 0.88729403, 0.18155967, 0.90815134,
0.043099014, 0.015312706, 0.032720325, 0.91985089, 0.026376147, 0.89711836, 0.039566532, 0.88189338, 0.019140791, 0.97606252, 0.10525012, 0.90684731, 0.073071952, 0.89485036,
0.24395593, 0.010703128, 0.086935754, 0.91006524, 0.10711009, 0.59156942, 0.071068548, 0.87752757, 0.13018776, 0.9474302, 0.092867756, 0.92486269, 0.057819905, 0.91354363,
0.19165186, 0.010602857, 0.057797946, 0.94384902, 0.076376147, 0.82305311, 0.27822581, 0.85110294, 0.30248526, 0.94344576, 0.082095097, 0.90882461, 0.044377424, 0.85189179,
0.25332638, 0.00052976355, 0.21089085, 0.89072693, 0.12568807, 0.69468921, 0.058215726, 0.76539522, 0.069180288, 0.79487892, 0.20276127, 0.83024533, 0.14295562, 0.85836254,
0.084081229, 0.19644893, 0.041796035, 0.87255359, 0.074541284, 0.90116694, 0.09047379, 0.90188419, 0.028012396, 0.9679701, 0.051758296, 0.79465397, 0.15605343, 0.93771906,
0.24171915, 0.0022857637, 0.046333891, 0.92078285, 0.10114679, 0.63348416, 0.16733871, 0.83088235, 0.203895, 0.931894, 0.04210005, 0.94734529, 0.088065489, 0.94589737,
0.18389581, 0.00072756088, 0.031764987, 0.94012116, 0.11926606, 0.71326506, 0.096774194, 0.8761489, 0.16072188, 0.98094267, 0.039437841, 0.95313072, 0.032313658, 0.93870765,
0.043799444, 0.0091533532, 0.050155242, 0.92311277, 0.017201835, 0.89402239, 0.04359879, 0.89292279, 0.015707602, 0.98381517, 0.076523031, 0.90801904, 0.055407152, 0.93870765,
0.094164527, 0.00055327562, 0.044662049, 0.93406337, 0.069954128, 0.83257919, 0.091481855, 0.90441176, 0.12897247, 0.93677415, 0.092620109, 0.94126694, 0.046617837, 0.91632965,
0.28448585, 0.0026110829, 0.12204442, 0.86812675, 0.11009174, 0.66658728, 0.084677419, 0.64797794, 0.058576897, 0.90097603, 0.15620357, 0.79326254, 0.12744507, 0.87220275,
0.14852868, 0.00020981759, 0.032720325, 0.84366263, 0.080733945, 0.89807097, 0.047127016, 0.72081801, 0.14452816, 0.82412898, 0.13564884, 0.88062981, 0.14364498, 0.87310146,
0.060132356, 0.00021560788, 0.039646525, 0.9361603, 0.056651376, 0.8899738, 0.085685484, 0.90670956, 0.068056146, 0.97912034, 0.046371966, 0.95708532, 0.040327445, 0.92486744,
0.032920842, 0.90442805, 0.11272988, 1.0, 0.078899083, 0.95784711, 0.065020161, 0.92899816, 0.014127727, 0.9801705, 0.08085686, 0.93496888, 0.026884963, 0.83337827,
0.16440648, 0.0045699055, 0.034631001, 0.90890028, 0.074770642, 0.72207668, 0.1577621, 0.90831801, 0.12350368, 0.95450334, 0.084076275, 0.92442329, 0.066006032, 0.94445942,
0.074779093, 0.00077065766, 0.058753284, 0.92031687, 0.040825688, 0.85567992, 0.056199597, 0.88028493, 0.060794799, 0.97115147, 0.061292719, 0.77561333, 0.051271004, 0.86411432,
0.067300513, 4.865174e-05, 0.029615476, 0.94617894, 0.045412844, 0.89449869, 0.14364919, 0.92440257, 0.071853922, 0.96864962, 0.030398712, 0.95591358, 0.020508402, 0.95434529,
0.23296423, 0.00062900323, 0.074755195, 0.92614166, 0.11834862, 0.65753751, 0.060987903, 0.76286765, 0.27599198, 0.77291821, 0.099430411, 0.89469059, 0.068160276, 0.87984183,
0.089126113, 0.094585334, 0.036302842, 0.83108108, 0.081422018, 0.95784711, 0.11743952, 0.92463235, 0.049857204, 0.9177786, 0.27637444, 0.86569022, 0.11598449, 0.92819268,
0.18832787, 5.4024921e-05, 0.073083353, 0.90167754, 0.12270642, 0.72731603, 0.076108871, 0.84926471, 0.12040469, 0.9835063, 0.08085686, 0.87645551, 0.060060319, 0.92540667,
0.10878873, 0.20751803, 0.067112491, 0.86556384, 0.09587156, 0.86806382, 0.084677419, 0.92509191, 0.037035912, 0.95298987, 0.15069341, 0.87718784, 0.21370099, 0.93610138,
0.18887998, 0.01085242, 0.080009553, 0.9137931, 0.1043578, 0.71278876, 0.078125, 0.83409926, 0.089809807, 0.85449098, 0.2604631, 0.82826803, 0.13433865, 0.84649951,
0.20577715, 0.013160311, 0.1170289, 0.88140727, 0.11192661, 0.74303406, 0.1313004, 0.83203125, 0.17472808, 0.81591302, 0.19421743, 0.76367631, 0.21732012, 0.7910488,
0.074439597, 0.00014837055, 0.046095056, 0.93476235, 0.059633028, 0.87473208, 0.049143145, 0.85661765, 0.029349213, 0.96713615, 0.077327885, 0.88465763, 0.067040069, 0.90383751,
0.36248522, 0.0046845263, 0.071889181, 0.93546132, 0.10619266, 0.3929507, 0.14163306, 0.80629596, 0.073342651, 0.98443291, 0.052686974, 0.91951666, 0.047134856, 0.91695875,
0.072325809, 0.00024086029, 0.077382374, 0.93173346, 0.042431193, 0.88211479, 0.042842742, 0.85592831, 0.043993437, 0.93232641, 0.10809807, 0.89710729, 0.076691081, 0.92369911,
0.1235699, 0.0026894837, 0.048722235, 0.93802423, 0.072018349, 0.80066683, 0.075856855, 0.84122243, 0.086923498, 0.98644057, 0.048972263, 0.91775906, 0.039207238, 0.9470657,
0.27536679, 0.015910672, 0.13876284, 0.92194781, 0.088761468, 0.61919505, 0.092741935, 0.69048713, 0.070790545, 0.90425006, 0.091567608, 0.88143537, 0.12270573, 0.69794194,
0.2275539, 0.004307389, 0.099355147, 0.80778192, 0.16077982, 0.76280067, 0.086441532, 0.81502757, 0.10108161, 0.90712256, 0.2039995, 0.69498352, 0.21146058, 0.7488092,
0.23214177, 0.0041980949, 0.094100788, 0.88373719, 0.1293578, 0.65896642, 0.069556452, 0.83915441, 0.080968585, 0.79849271, 0.16171372, 0.84210912, 0.13856097, 0.82430125,
0.085607173, 0.0017218939, 0.057320277, 0.92054986, 0.048165138, 0.86234818, 0.044354839, 0.83639706, 0.043233882, 0.94316778, 0.14945518, 0.85719517, 0.10021542, 0.8581828,
0.23378755, 0.011015638, 0.11487939, 0.9137931, 0.086697248, 0.64134318, 0.16910282, 0.85592831, 0.13109923, 0.88389548, 0.11032689, 0.745368, 0.25282206, 0.76076211,
0.20104035, 7.5831893e-05, 0.044423215, 0.82642125, 0.12752294, 0.87568469, 0.29939516, 0.88419118, 0.025126086, 0.96423277, 0.075780089, 0.88143537, 0.048944421, 0.93070909,
0.21242902, 0.0038625733, 0.11368522, 0.87278658, 0.075688073, 0.68873541, 0.15398185, 0.85799632, 0.15106034, 0.91858167, 0.15781327, 0.83317466, 0.18759156, 0.86285612,
0.20785234, 0.00029754009, 0.071650346, 0.86626281, 0.091972477, 0.67206478, 0.11592742, 0.87408088, 0.072583095, 0.93362367, 0.11527984, 0.86459172, 0.1552779, 0.78556664,
0.049464508, 8.2708663e-05, 0.038452353, 0.9417521, 0.055275229, 0.90997857, 0.022177419, 0.85340074, 0.0047092423, 0.93587843, 0.086800396, 0.9178323, 0.0085308057, 0.92001438,
0.09044799, 0.56511043, 0.15643659, 0.97087605, 0.11238532, 0.91926649, 0.058971774, 0.89636949, 0.029045391, 0.92667408, 0.16202328, 0.84518491, 0.039896596, 0.79122854,
0.15717007, 0.0060333245, 0.062096967, 0.91868593, 0.088761468, 0.74422482, 0.0546875, 0.83869485, 0.066719329, 0.90193353, 0.12877662, 0.78125229, 0.14536838, 0.84964501,
0.19037666, 0.0015047923, 0.048722235, 0.93010252, 0.11284404, 0.73827102, 0.23261089, 0.92026654, 0.1304612, 0.95870398, 0.0350421, 0.88773343, 0.018612667, 0.88110003,
0.061391522, 0.00055916456, 0.055170767, 0.93313141, 0.03646789, 0.88044773, 0.070564516, 0.88924632, 0.04940147, 0.97550655, 0.090081724, 0.90889784, 0.05971564, 0.92387885,
0.10644008, 0.052050474, 0.12777645, 0.93849021, 0.12889908, 0.89092641, 0.065272177, 0.92463235, 0.022573981, 0.9775451, 0.20078009, 0.9169535, 0.0492891, 0.77945538,
0.0420198, 0.00039659658, 0.06281347, 0.93289842, 0.080963303, 0.96356275, 0.11391129, 0.96415441, 0.02214863, 0.98344453, 0.043524022, 0.63354083, 0.10150797, 0.86950661,
0.38159878, 0.00075062906, 0.13685216, 0.84016775, 0.17614679, 0.45606097, 0.094758065, 0.7902114, 0.10332989, 0.92015691, 0.1679049, 0.79509337, 0.17483843, 0.77702885,
0.16440648, 0.0021746898, 0.034631001, 0.90890028, 0.074770642, 0.72207668, 0.1577621, 0.90831801, 0.12350368, 0.94869657, 0.084076275, 0.92442329, 0.066006032, 0.94445942,
0.072667598, 3.9003124e-05, 0.039885359, 0.93849021, 0.056880734, 0.87639914, 0.053427419, 0.85661765, 0.034423042, 0.96763034, 0.068103021, 0.88465763, 0.055751831, 0.91003864,
0.20168068, 0.0085410867, 0.058275615, 0.85321528, 0.22775229, 0.90664444, 0.061995968, 0.71185662, 0.092635353, 0.87138621, 0.10902675, 0.8544123, 0.19534683, 0.91021839,
0.29904915, 0.00023822936, 0.065201815, 0.89515377, 0.079587156, 0.6322934, 0.25680444, 0.73805147, 0.065321748, 0.93192488, 0.23161218, 0.78366899, 0.061352865, 0.83841107,
0.23354665, 0.0043723717, 0.089324098, 0.92357875, 0.16307339, 0.76446773, 0.10735887, 0.72495404, 0.16594762, 0.89844329, 0.1265478, 0.84262175, 0.039465748, 0.88981756,
0.1760954, 5.5452415e-05, 0.044662049, 0.92427773, 0.063990826, 0.67158847, 0.079889113, 0.86971507, 0.16473233, 0.78351248, 0.090762754, 0.88575613, 0.16053425, 0.79599173,
0.13557991, 0.0033128996, 0.025794125, 0.93359739, 0.042889908, 0.73541319, 0.1484375, 0.91590074, 0.11505742, 0.97433284, 0.063831105, 0.94683266, 0.051443343, 0.94409994,
0.26099112, 0.010955136, 0.1315978, 0.85507922, 0.15137615, 0.69730888, 0.14289315, 0.80606618, 0.16913775, 0.78641586, 0.15626548, 0.70750641, 0.19250323, 0.74853959,
0.27907915, 0.0013595981, 0.077382374, 0.888863, 0.14678899, 0.5822815, 0.080141129, 0.82789522, 0.14127727, 0.88525451, 0.18084448, 0.80739656, 0.10392072, 0.8345466,
0.1495278, 0.00070781694, 0.035825173, 0.93429637, 0.049541284, 0.71064539, 0.083921371, 0.86443015, 0.17797898, 0.95490487, 0.030522536, 0.95327719, 0.018871176, 0.93313562,
0.17041166, 0.0016075578, 0.047766898, 0.92148183, 0.070412844, 0.7061205, 0.11517137, 0.8671875, 0.11757915, 0.93476649, 0.10333086, 0.89242036, 0.08056872, 0.85288038,
0.21223559, 0.0012128608, 0.093623119, 0.86463187, 0.12041284, 0.69421291, 0.084929435, 0.86856618, 0.10709728, 0.90777119, 0.26752105, 0.85997803, 0.2299009, 0.71771367,
0.24559729, 0.0021435611, 0.079531884, 0.85438024, 0.29816514, 0.82376756, 0.080141129, 0.81778493, 0.0481558, 0.93791698, 0.10308321, 0.86129623, 0.1068505, 0.85863216,
0.11932577, 0.054941381, 0.1800812, 0.93639329, 0.13188073, 0.97832817, 0.13986895, 0.91130515, 0.074406028, 0.96018656, 0.15026003, 0.71724643, 0.13399397, 0.88334681,
0.27576806, 0.0011084776, 0.087174588, 0.90214352, 0.055504587, 0.61657538, 0.18195565, 0.72380515, 0.28200766, 0.93325303, 0.052686974, 0.84240205, 0.063679449, 0.94877325,
0.20837242, 0.0019437064, 0.058992118, 0.90680336, 0.087385321, 0.65539414, 0.069808468, 0.81594669, 0.080634381, 0.90832716, 0.091010401, 0.87008422, 0.16070659, 0.84425272,
0.17256302, 0.00024706629, 0.072605684, 0.88397018, 0.085321101, 0.89735651, 0.33014113, 0.9296875, 0.052135869, 0.92469731, 0.2222635, 0.85221531, 0.091684619, 0.88730116,
0.11305179, 0.00014528727, 0.027227132, 0.93942218, 0.069724771, 0.82138604, 0.064768145, 0.82789522, 0.23047943, 0.94702866, 0.046000495, 0.94126694, 0.05256355, 0.96288308,
0.12903533, 0.00055984801, 0.068067829, 0.88979497, 0.072706422, 0.84710645, 0.097530242, 0.83111213, 0.076259343, 0.96355325, 0.12363794, 0.90186745, 0.12322275, 0.85189179,
0.16670234, 0.014655922, 0.047528063, 0.93406337, 0.05940367, 0.81900452, 0.24647177, 0.86626838, 0.29467704, 0.93563133, 0.064574047, 0.90721347, 0.052132701, 0.95380606,
0.37776552, 0.00019732385, 0.17219967, 0.86276794, 0.13509174, 0.42414861, 0.1156754, 0.81456801, 0.32812785, 0.73764517, 0.21545319, 0.66861955, 0.10943559, 0.74530421,
0.21211094, 0.00071472894, 0.10699785, 0.88466915, 0.10848624, 0.70588235, 0.044354839, 0.77068015, 0.11882482, 0.81041512, 0.080733036, 0.75093372, 0.1022835, 0.74647254,
0.20287789, 0.0030514033, 0.09792214, 0.9193849, 0.13577982, 0.72183853, 0.18674395, 0.92876838, 0.11125965, 0.94523721, 0.045752848, 0.90223361, 0.07014218, 0.9240586,
0.077323232, 0.0058256094, 0.037497015, 0.92753961, 0.052981651, 0.9018814, 0.046118952, 0.82123162, 0.048064653, 0.88571782, 0.095901436, 0.87638228, 0.04911676, 0.94248225,
0.199741, 0.0001278727, 0.072605684, 0.87744641, 0.11077982, 0.70278638, 0.062247984, 0.82950368, 0.10147658, 0.83144922, 0.16598564, 0.67792018, 0.16303318, 0.8537791,
0.22922115, 0.054640867, 0.12204442, 0.90866729, 0.175, 0.74755894, 0.13936492, 0.82996324, 0.11539163, 0.94594762, 0.075965825, 0.89264006, 0.082722964, 0.91390312,
0.1906836, 0.0087254109, 0.055648436, 0.93266542, 0.059174312, 0.65396523, 0.1469254, 0.89131434, 0.096524275, 0.975383, 0.046310054, 0.92178689, 0.028866868, 0.95892873,
0.30636085, 0.0061524533, 0.090757105, 0.82129543, 0.092201835, 0.51655156, 0.067792339, 0.76401654, 0.19146868, 0.65143934, 0.16375681, 0.75034786, 0.20663507, 0.7034241,
0.14556922, 0.0024140775, 0.043229042, 0.92357875, 0.047477064, 0.75208383, 0.20640121, 0.92624081, 0.082669988, 0.95623301, 0.098749381, 0.95803735, 0.071951745, 0.91938528,
0.040121349, 0.0014844509, 0.057559112, 0.93546132, 0.022018349, 0.89473684, 0.03452621, 0.89407169, 0.022300541, 0.97874969, 0.14208767, 0.97275723, 0.084963378, 0.95551362,
0.2128599, 0.0079467323, 0.11368522, 0.87581547, 0.1190367, 0.73779471, 0.13684476, 0.83203125, 0.14677645, 0.82666172, 0.11032689, 0.76045405, 0.21576907, 0.79590186,

};

static float g_rhos[NR_CLASSIFER(NR_CLASS)] = {
-1.124224f
};

static int32_t g_nr_sv[NR_CLASS] = {
138, 133
};

static float g_probA[NR_CLASSIFER(NR_CLASS)];

static float g_probB[NR_CLASSIFER(NR_CLASS)];

static float sigmoid_predict(float decision_value, float A, float B)
{
	float fApB = decision_value*A+B;
	// 1-p used later; avoid catastrophic cancellation
	if (fApB >= 0)
		return expf(-fApB)/(1.0+expf(-fApB));
	else
		return 1.0/(1+expf(fApB)) ;
}

static float linear_kernel(const float *xi, const float *x, const Model *model)
{
    float sum = 0.f;
    int i = 0;
    int len = model->vec_dim;
    for (i = 0; i < len; i++)
    {
        sum += xi[i] * x[i];
    }
    return sum;
}

static float polynomial_kernel(const float *xi, const float *x, const Model *model)
{
    float sum = 0.f;
    int i = 0;
    int len = model->vec_dim;
    float res = 0;

    for (i = 0; i < len; i++)
    {
        sum += xi[i] * x[i];
    }
    
    res = (model->gamma * sum + model->coef0);
    return res * res;
}

static float rbf_kernel(const float *xi, const float *x, const Model *model)
{
    float sum = 0.f;
    int i = 0;
    int len = model->vec_dim;
    float res = 0.;
    float temp = 0.;
    for (i = 0; i < len; i++)
    {
        temp = xi[i] - x[i];
        sum += temp*temp;
    }
    
    res = exp(-model->gamma*sum);
    return res;
}

void init_svm_params(Model *svm_model)
{
    svm_model->kernel_type = KERNEL_RBF;
    svm_model->degree   = 3;
    svm_model->gamma    = 8.0;
    svm_model->coef0    = 0;
    svm_model->nr_class = NR_CLASS;
    svm_model->nr_sv    = g_nr_sv;
    svm_model->total_sv = TOTAL_SV;
    svm_model->rhos     = g_rhos;
    svm_model->label    = g_label;
    svm_model->probA    = g_probA;
    svm_model->probB    = g_probB;

    // support vectors
    svm_model->coefs    = g_coefs;
    svm_model->vec_dim  = 14;
    svm_model->SVs      = g_SVs;
}


float predict(const Model *svm_model, const float* x, int len)
{
    int i = 0;
    float sum = 0.f;
    KernelHandle kernel;
    if (len != svm_model->vec_dim)
    {
        // len == feature num == vector dim
        return 0;
    }
    switch (svm_model->kernel_type)
    {
    case KERNEL_LINEAR:
        kernel = linear_kernel;
        break;
    case KERNEL_POLYNOMIAL:
        kernel = polynomial_kernel;
        break;
    case KERNEL_RBF:
        kernel = rbf_kernel;
        break;
    default:
        return 0;
    }

    for (i = 0; i < svm_model->total_sv; i++)
    {
        float* xi = svm_model->SVs + i * svm_model->vec_dim;
        sum += svm_model->coefs[0][i] * kernel(xi, x, svm_model);
    }

    return sum-svm_model->rhos[0];
}

float predict_probability(const Model *svm_model, const float* x, int len)
{
    float score = predict(svm_model, x, len);
    return sigmoid_predict(score, svm_model->probA[0], svm_model->probB[0]);
}

static int32_t svm_predict_values(const Model *svm_model, const float *x, float* dec_values)
{
    int i = 0;
    int j = 0;
    KernelHandle kernel;
    int nr_class = svm_model->nr_class;
    int l = svm_model->total_sv;
    float kvalue[TOTAL_SV];
    switch (svm_model->kernel_type)
    {
    case KERNEL_LINEAR:
        kernel = linear_kernel;
        break;
    case KERNEL_POLYNOMIAL:
        kernel = polynomial_kernel;
        break;
    case KERNEL_RBF:
        kernel = rbf_kernel;
        break;
    default:
        return -1;
    }

    for (i = 0; i < l; i++)
    {
        float* xi = svm_model->SVs + i * svm_model->vec_dim;
        kvalue[i] = kernel(xi, x, svm_model);
    }

    int start[NR_CLASS];
    start[0] = 0;
    for (i = 1; i < nr_class; i++)
        start[i] = start[i-1] + svm_model->nr_sv[i-1];
    
    int vote[NR_CLASS];
    for (i = 0; i < nr_class; i++)
        vote[i] = 0;

    int p = 0;
    for (i = 0; i < nr_class; i++)
    {
        for (j = i+1; j < nr_class; j++)
        {
            float sum = 0;
            int si = start[i];
            int sj = start[j];
            int ci = svm_model->nr_sv[i];
            int cj = svm_model->nr_sv[j];

            int k;
            float *coef1 = svm_model->coefs[j-1];
            float *coef2 = svm_model->coefs[i];
            for(k = 0; k < ci; k++)
            {
                sum += coef1[si+k] * kvalue[si+k];
            }
            for(k = 0; k < cj; k++)
                sum += coef2[sj+k] * kvalue[sj+k];
            sum -= svm_model->rhos[p];
            dec_values[p] = sum;

            if(dec_values[p] > 0)
                ++vote[i];
            else
                ++vote[j];
            p++;
        }
    }

    int vote_max_idx = 0;
    for(i=1;i<nr_class;i++)
        if(vote[i] > vote[vote_max_idx])
            vote_max_idx = i;

    return svm_model->label[vote_max_idx];
}

// Method 2 from the multiclass_prob paper by Wu, Lin, and Weng
static void multiclass_probability(int k, float (*r)[NR_CLASS], float *p)
{
    int t,j;
    int iter = 0, max_iter=MAX(100,k);
    float Q[k][k];
    float Qp[k];
    float pQp, eps=0.005/k;

    for (t = 0; t < k; t++)
    {
        p[t] = 1.0/k;  // Valid if k = 1
        Q[t][t] = 0;
        for (j = 0; j < t; j++)
        {
            Q[t][t] += r[j][t] * r[j][t];
            Q[t][j] = Q[j][t];
        }
        for (j = t+1; j < k; j++)
        {
            Q[t][t] += r[j][t]*r[j][t];
            Q[t][j] =  -r[j][t]*r[t][j];
        }
    }
    for (iter = 0; iter < max_iter; iter++)
    {
        // stopping condition, recalculate QP,pQP for numerical accuracy
        pQp = 0;
        for (t = 0; t < k; t++)
        {
            Qp[t] = 0;
            for (j = 0; j < k; j++)
                Qp[t] += Q[t][j]*p[j];
            pQp += p[t]*Qp[t];
        }
        float max_error=0;
        for (t = 0; t < k; t++)
        {
            float error = fabsf(Qp[t]-pQp);
            if (error > max_error)
                max_error = error;
        }
        if (max_error < eps) break;

        for (t = 0; t < k; t++)
        {
            float diff = (-Qp[t] + pQp) / Q[t][t];
            p[t] += diff;
            pQp = (pQp + diff * (diff*Q[t][t] + 2*Qp[t])) / (1 + diff) / (1 + diff);
            for (j = 0; j < k; j++)
            {
                Qp[j] = (Qp[j] + diff*Q[t][j]) / (1 + diff);
                p[j] /= (1 + diff);
            }
        }
    }
    if (iter >= max_iter)
    {
#ifdef DEBUG_MODE
        printf("Exceeds max_iter in multiclass_prob\n");
#endif
    }
}

int32_t multi_predict(const Model* svm_model, const float* x, int len) {
    float dec_values[NR_CLASSIFER(NR_CLASS)];
    int label = svm_predict_values(svm_model, x, dec_values);
    return label;
}

int32_t multi_predict_probability(const Model *svm_model, const float* x, int len, float* scores_buf, int scores_buf_len)
{
    float dec_values[NR_CLASSIFER(NR_CLASS)];
    int32_t res = svm_predict_values(svm_model, x, dec_values);
    if (res < 0) return res;

    float min_prob=1e-7;
    float pairwise_prob[NR_CLASS][NR_CLASS];
    int i, j;
    int k=0;
    for (i = 0; i < NR_CLASS; i++)
    {
        for (j = i+1; j < NR_CLASS; j++)
        {
            pairwise_prob[i][j]=MIN(MAX(sigmoid_predict(dec_values[k],svm_model->probA[k],svm_model->probB[k]),min_prob),1-min_prob);
            pairwise_prob[j][i]=1-pairwise_prob[i][j];
            k++;
        }
    }
    float scores[NR_CLASS];
	multiclass_probability(NR_CLASS, pairwise_prob, scores);

    int prob_max_idx = 0;
    for (i = 1; i < NR_CLASS; i++)
        if(scores[i] > scores[prob_max_idx])
            prob_max_idx = i;
    if (scores_buf_len < NR_CLASS)
    {
        return -1;
    }
    for (i = 0; i < NR_CLASS; i++)
        scores_buf[i] = (float)scores[i];
    return svm_model->label[prob_max_idx];
}
